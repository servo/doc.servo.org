<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="In order to compute restyle hints, we perform a selector match against a list of partial selectors whose rightmost simple selector may be sensitive to the thing being changed. We do this matching twice, once for the element as it exists now and once for the element as it existed at the time of the last restyle. If the results of the selector match differ, that means that the given partial selector is sensitive to the change, and we compute a restyle hint based on its combinator."><title>ElementSnapshot in style::invalidation::element::element_wrapper - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="style" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.1 (3f5fd8dd4 2024-08-06)" data-channel="1.80.1" data-search-js="search-d52510db62a78183.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../style/index.html">style</a><span class="version">0.0.1</span></h2></div><h2 class="location"><a href="#">ElementSnapshot</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.each_class">each_class</a></li><li><a href="#tymethod.each_custom_state">each_custom_state</a></li><li><a href="#tymethod.has_attrs">has_attrs</a></li><li><a href="#tymethod.has_class">has_class</a></li><li><a href="#tymethod.has_custom_state">has_custom_state</a></li><li><a href="#tymethod.has_custom_states">has_custom_states</a></li><li><a href="#tymethod.id_attr">id_attr</a></li><li><a href="#tymethod.imported_part">imported_part</a></li><li><a href="#tymethod.is_part">is_part</a></li><li><a href="#tymethod.lang_attr">lang_attr</a></li><li><a href="#tymethod.state">state</a></li></ul><h3><a href="#provided-methods">Provided Methods</a></h3><ul class="block"><li><a href="#method.debug_list_attributes">debug_list_attributes</a></li></ul><h3><a href="#object-safety">Object Safety</a></h3><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In style::invalidation::element::element_wrapper</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../../../index.html">style</a>::<wbr><a href="../../index.html">invalidation</a>::<wbr><a href="../index.html">element</a>::<wbr><a href="index.html">element_wrapper</a>::<wbr><a class="trait" href="#">ElementSnapshot</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#41-89">source</a> Â· <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub trait ElementSnapshot: <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a> {
    // Required methods
    fn <a href="#tymethod.state" class="fn">state</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../../../../dom/struct.ElementState.html" title="struct dom::ElementState">ElementState</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.has_attrs" class="fn">has_attrs</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.id_attr" class="fn">id_attr</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;<a class="type" href="../../../type.Atom.html" title="type style::Atom">WeakAtom</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.has_class" class="fn">has_class</a>(
        &amp;self,
        name: &amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>,
        case_sensitivity: <a class="enum" href="../../../../selectors/attr/enum.CaseSensitivity.html" title="enum selectors::attr::CaseSensitivity">CaseSensitivity</a>,
    ) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.is_part" class="fn">is_part</a>(&amp;self, name: &amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.imported_part" class="fn">imported_part</a>(&amp;self, name: &amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.each_class" class="fn">each_class</a>&lt;F&gt;(&amp;self, _: F)
       <span class="where">where F: <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(&amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>)</span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.has_custom_states" class="fn">has_custom_states</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.has_custom_state" class="fn">has_custom_state</a>(&amp;self, state: &amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.each_custom_state" class="fn">each_custom_state</a>&lt;F&gt;(&amp;self, callback: F)
       <span class="where">where F: <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(&amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>)</span>;
<span class="item-spacer"></span>    fn <a href="#tymethod.lang_attr" class="fn">lang_attr</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="../../../selector_parser/type.AttrValue.html" title="type style::selector_parser::AttrValue">AttrValue</a>&gt;;

    // Provided method
    fn <a href="#method.debug_list_attributes" class="fn">debug_list_attributes</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.80.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a> { ... }
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>In order to compute restyle hints, we perform a selector match against a
list of partial selectors whose rightmost simple selector may be sensitive
to the thing being changed. We do this matching twice, once for the element
as it exists now and once for the element as it existed at the time of the
last restyle. If the results of the selector match differ, that means that
the given partial selector is sensitive to the change, and we compute a
restyle hint based on its combinator.</p>
<p>In order to run selector matching against the old element state, we generate
a wrapper for the element which claims to have the old state. This is the
ElementWrapper logic below.</p>
<p>Gecko does this differently for element states, and passes a mask called
mStateMask, which indicates the states that need to be ignored during
selector matching. This saves an ElementWrapper allocation and an additional
selector match call at the expense of additional complexity inside the
selector matching logic. This only works for boolean states though, so we
still need to take the ElementWrapper approach for attribute-dependent
style. So we do it the same both ways for now to reduce complexity, but itâs
worth measuring the performance impact (if any) of the mStateMask approach.</p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">Â§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.state" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#43">source</a><h4 class="code-header">fn <a href="#tymethod.state" class="fn">state</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../../../../dom/struct.ElementState.html" title="struct dom::ElementState">ElementState</a>&gt;</h4></section></summary><div class="docblock"><p>The state of the snapshot, if any.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.has_attrs" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#46">source</a><h4 class="code-header">fn <a href="#tymethod.has_attrs" class="fn">has_attrs</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>If this snapshot contains attribute information.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.id_attr" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#57">source</a><h4 class="code-header">fn <a href="#tymethod.id_attr" class="fn">id_attr</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;&amp;<a class="type" href="../../../type.Atom.html" title="type style::Atom">WeakAtom</a>&gt;</h4></section></summary><div class="docblock"><p>The ID attribute per this snapshot. Should only be called if
<code>has_attrs()</code> returns true.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.has_class" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#61">source</a><h4 class="code-header">fn <a href="#tymethod.has_class" class="fn">has_class</a>(&amp;self, name: &amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>, case_sensitivity: <a class="enum" href="../../../../selectors/attr/enum.CaseSensitivity.html" title="enum selectors::attr::CaseSensitivity">CaseSensitivity</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Whether this snapshot contains the class <code>name</code>. Should only be called
if <code>has_attrs()</code> returns true.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.is_part" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#65">source</a><h4 class="code-header">fn <a href="#tymethod.is_part" class="fn">is_part</a>(&amp;self, name: &amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Whether this snapshot represents the part named <code>name</code>. Should only be
called if <code>has_attrs()</code> returns true.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.imported_part" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#68">source</a><h4 class="code-header">fn <a href="#tymethod.imported_part" class="fn">imported_part</a>(&amp;self, name: &amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>&gt;</h4></section></summary><div class="docblock"><p>See Element::imported_part.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.each_class" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#72-74">source</a><h4 class="code-header">fn <a href="#tymethod.each_class" class="fn">each_class</a>&lt;F&gt;(&amp;self, _: F)<div class="where">where
    F: <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(&amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>),</div></h4></section></summary><div class="docblock"><p>A callback that should be called for each class of the snapshot. Should
only be called if <code>has_attrs()</code> returns true.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.has_custom_states" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#77">source</a><h4 class="code-header">fn <a href="#tymethod.has_custom_states" class="fn">has_custom_states</a>(&amp;self) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>If this snapshot contains CustomStateSet information.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.has_custom_state" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#80">source</a><h4 class="code-header">fn <a href="#tymethod.has_custom_state" class="fn">has_custom_state</a>(&amp;self, state: &amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>A callback that should be called for each CustomState of the snapshot.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.each_custom_state" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#83-85">source</a><h4 class="code-header">fn <a href="#tymethod.each_custom_state" class="fn">each_custom_state</a>&lt;F&gt;(&amp;self, callback: F)<div class="where">where
    F: <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/ops/function/trait.FnMut.html" title="trait core::ops::function::FnMut">FnMut</a>(&amp;<a class="type" href="../../../values/type.AtomIdent.html" title="type style::values::AtomIdent">AtomIdent</a>),</div></h4></section></summary><div class="docblock"><p>A callback that should be called for each CustomState of the snapshot.</p>
</div></details><details class="toggle method-toggle" open><summary><section id="tymethod.lang_attr" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#88">source</a><h4 class="code-header">fn <a href="#tymethod.lang_attr" class="fn">lang_attr</a>(&amp;self) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="type" href="../../../selector_parser/type.AttrValue.html" title="type style::selector_parser::AttrValue">AttrValue</a>&gt;</h4></section></summary><div class="docblock"><p>The <code>xml:lang=&quot;&quot;</code> or <code>lang=&quot;&quot;</code> attribute value per this snapshot.</p>
</div></details></div><h2 id="provided-methods" class="section-header">Provided Methods<a href="#provided-methods" class="anchor">Â§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="method.debug_list_attributes" class="method"><a class="src rightside" href="../../../../src/style/invalidation/element/element_wrapper.rs.html#51-53">source</a><h4 class="code-header">fn <a href="#method.debug_list_attributes" class="fn">debug_list_attributes</a>(&amp;self) -&gt; <a class="struct" href="https://doc.rust-lang.org/1.80.1/alloc/string/struct.String.html" title="struct alloc::string::String">String</a></h4></section></summary><div class="docblock"><p>Gets the attribute information of the snapshot as a string.</p>
<p>Only for debugging purposes.</p>
</div></details></div><h2 id="object-safety" class="section-header">Object Safety<a href="#object-safety" class="anchor">Â§</a></h2><div class="object-safety-info">This trait is <b>not</b> <a href="https://doc.rust-lang.org/1.80.1/reference/items/traits.html#object-safety">object safe</a>.</div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">Â§</a></h2><div id="implementors-list"><section id="impl-ElementSnapshot-for-ServoElementSnapshot" class="impl"><a class="src rightside" href="../../../../src/style/servo/selector_parser.rs.html#798-864">source</a><a href="#impl-ElementSnapshot-for-ServoElementSnapshot" class="anchor">Â§</a><h3 class="code-header">impl <a class="trait" href="trait.ElementSnapshot.html" title="trait style::invalidation::element::element_wrapper::ElementSnapshot">ElementSnapshot</a> for <a class="struct" href="../../../servo/selector_parser/struct.ServoElementSnapshot.html" title="struct style::servo::selector_parser::ServoElementSnapshot">ServoElementSnapshot</a></h3></section></div><script src="../../../../trait.impl/style/invalidation/element/element_wrapper/trait.ElementSnapshot.js" async></script></section></div></main></body></html>