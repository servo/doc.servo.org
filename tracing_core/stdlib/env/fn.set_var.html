<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Sets the environment variable `key` to the value `value` for the currently running process."><title>set_var in tracing_core::stdlib::env - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../../../" data-static-root-path="../../../static.files/" data-current-crate="tracing_core" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.1 (3f5fd8dd4 2024-08-06)" data-channel="1.80.1" data-search-js="search-d52510db62a78183.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc fn"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button><a class="logo-container" href="../../../tracing_core/index.html"><img src="https://raw.githubusercontent.com/tokio-rs/tracing/master/assets/logo-type.png" alt=""></a></nav><nav class="sidebar"><div class="sidebar-crate"><a class="logo-container" href="../../../tracing_core/index.html"><img src="https://raw.githubusercontent.com/tokio-rs/tracing/master/assets/logo-type.png" alt="logo"></a><h2><a href="../../../tracing_core/index.html">tracing_core</a><span class="version">0.1.32</span></h2></div><div class="sidebar-elems"><h2><a href="index.html">In tracing_core::stdlib::env</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Function <a href="../../index.html">tracing_core</a>::<wbr><a href="../index.html">stdlib</a>::<wbr><a href="index.html">env</a>::<wbr><a class="fn" href="#">set_var</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><span class="since" title="Stable since Rust version 1.0.0">1.0.0</span> · <a class="src" href="https://doc.rust-lang.org/1.80.1/src/std/env.rs.html#367">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>pub unsafe fn set_var&lt;K, V&gt;(key: K, value: V)<div class="where">where
    K: <a class="trait" href="../convert/trait.AsRef.html" title="trait tracing_core::stdlib::convert::AsRef">AsRef</a>&lt;<a class="struct" href="../ffi/struct.OsStr.html" title="struct tracing_core::stdlib::ffi::OsStr">OsStr</a>&gt;,
    V: <a class="trait" href="../convert/trait.AsRef.html" title="trait tracing_core::stdlib::convert::AsRef">AsRef</a>&lt;<a class="struct" href="../ffi/struct.OsStr.html" title="struct tracing_core::stdlib::ffi::OsStr">OsStr</a>&gt;,</div></code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Sets the environment variable <code>key</code> to the value <code>value</code> for the currently running
process.</p>
<h2 id="safety"><a class="doc-anchor" href="#safety">§</a>Safety</h2>
<p>This function is safe to call in a single-threaded program.</p>
<p>This function is also always safe to call on Windows, in single-threaded
and multi-threaded programs.</p>
<p>In multi-threaded programs on other operating systems, we strongly suggest
not using <code>set_var</code> or <code>remove_var</code> at all. The exact requirement is: you
must ensure that there are no other threads concurrently writing or
<em>reading</em>(!) the environment through functions or global variables other
than the ones in this module. The problem is that these operating systems
do not provide a thread-safe way to read the environment, and most C
libraries, including libc itself, do not advertise which functions read
from the environment. Even functions from the Rust standard library may
read the environment without going through this module, e.g. for DNS
lookups from <a href="../net/trait.ToSocketAddrs.html" title="trait tracing_core::stdlib::net::ToSocketAddrs"><code>std::net::ToSocketAddrs</code></a>. No stable guarantee is made about
which functions may read from the environment in future versions of a
library. All this makes it not practically possible for you to guarantee
that no other thread will read the environment, so the only safe option is
to not use <code>set_var</code> or <code>remove_var</code> in multi-threaded programs at all.</p>
<p>Discussion of this unsafety on Unix may be found in:</p>
<ul>
<li><a href="https://austingroupbugs.net/view.php?id=188">Austin Group Bugzilla</a></li>
<li><a href="https://sourceware.org/bugzilla/show_bug.cgi?id=15607#c2">GNU C library Bugzilla</a></li>
</ul>
<h2 id="panics"><a class="doc-anchor" href="#panics">§</a>Panics</h2>
<p>This function may panic if <code>key</code> is empty, contains an ASCII equals sign <code>'='</code>
or the NUL character <code>'\0'</code>, or when <code>value</code> contains the NUL character.</p>
<h2 id="examples"><a class="doc-anchor" href="#examples">§</a>Examples</h2>
<div class="example-wrap"><pre class="rust rust-example-rendered"><code><span class="kw">use </span>std::env;

<span class="kw">let </span>key = <span class="string">"KEY"</span>;
<span class="kw">unsafe </span>{
    env::set_var(key, <span class="string">"VALUE"</span>);
}
<span class="macro">assert_eq!</span>(env::var(key), <span class="prelude-val">Ok</span>(<span class="string">"VALUE"</span>.to_string()));</code></pre></div>
</div></details></section></div></main></body></html>