<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A compiler uses a builder configuration and builds up the NFA formulation of an Aho-Corasick automaton. This roughly corresponds to the standard formulation described in textbooks."><meta name="keywords" content="rust, rustlang, rust-lang, Compiler"><title>Compiler in aho_corasick::nfa - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled><link rel="stylesheet" type="text/css" href="../../dark.css" disabled><link rel="stylesheet" type="text/css" href="../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><script defer src="../../main.js"></script>
    <noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"></head><body class="rustdoc struct"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../aho_corasick/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"></h2>
    </nav>
    <nav class="sidebar"><a class="sidebar-logo" href="../../aho_corasick/index.html"><div class="logo-container"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></div>
        </a><h2 class="location"><a href="#">Compiler</a></h2><div class="sidebar-elems"><div class="block items"><h3 class="sidebar-title"><a href="#fields">Fields</a></h3><div class="sidebar-links"><a href="#structfield.builder">builder</a><a href="#structfield.byte_classes">byte_classes</a><a href="#structfield.nfa">nfa</a><a href="#structfield.prefilter">prefilter</a></div><h3 class="sidebar-title"><a href="#implementations">Methods</a></h3><div class="sidebar-links"><a href="#method.add_dead_state_loop">add_dead_state_loop</a><a href="#method.add_start_state_loop">add_start_state_loop</a><a href="#method.add_state">add_state</a><a href="#method.build_trie">build_trie</a><a href="#method.calculate_size">calculate_size</a><a href="#method.close_start_state_loop">close_start_state_loop</a><a href="#method.compile">compile</a><a href="#method.fill_failure_transitions_leftmost">fill_failure_transitions_leftmost</a><a href="#method.fill_failure_transitions_standard">fill_failure_transitions_standard</a><a href="#method.match_kind">match_kind</a><a href="#method.new">new</a><a href="#method.queued_set">queued_set</a></div><h3 class="sidebar-title"><a href="#trait-implementations">Trait Implementations</a></h3><div class="sidebar-links"><a href="#impl-Debug">Debug</a></div><h3 class="sidebar-title"><a href="#synthetic-implementations">Auto Trait Implementations</a></h3><div class="sidebar-links"><a href="#impl-RefUnwindSafe">RefUnwindSafe</a><a href="#impl-Send">Send</a><a href="#impl-Sync">Sync</a><a href="#impl-Unpin">Unpin</a><a href="#impl-UnwindSafe">UnwindSafe</a></div><h3 class="sidebar-title"><a href="#blanket-implementations">Blanket Implementations</a></h3><div class="sidebar-links"><a href="#impl-Any">Any</a><a href="#impl-Borrow%3CT%3E">Borrow&lt;T&gt;</a><a href="#impl-BorrowMut%3CT%3E">BorrowMut&lt;T&gt;</a><a href="#impl-From%3CT%3E">From&lt;T&gt;</a><a href="#impl-Into%3CU%3E">Into&lt;U&gt;</a><a href="#impl-TryFrom%3CU%3E">TryFrom&lt;U&gt;</a><a href="#impl-TryInto%3CU%3E">TryInto&lt;U&gt;</a></div></div><h2 class="location">In <a href="../index.html">aho_corasick</a>::<wbr><a href="index.html">nfa</a></h2><div id="sidebar-vars" data-name="Compiler" data-ty="struct" data-relpath=""></div><script defer src="sidebar-items.js"></script></div></nav><main><div class="width-limiter"><div class="sub-container"><a class="sub-logo-container" href="../../aho_corasick/index.html"><img class="rust-logo" src="../../rust-logo.svg" alt="logo"></a><nav class="sub"><div class="theme-picker hidden"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><form class="search-form"><div class="search-container"><div>
                                <input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel.svg"></a></div></form></nav></div><section id="main-content" class="content"><div class="main-heading">
    <h1 class="fqn"><span class="in-band">Struct <a href="../index.html">aho_corasick</a>::<wbr><a href="index.html">nfa</a>::<wbr><a class="struct" href="#">Compiler</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span></h1><span class="out-of-band"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#612-617" title="goto source code">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="docblock item-decl"><pre class="rust struct"><code>struct Compiler&lt;'a, S:&nbsp;<a class="trait" href="../state_id/trait.StateID.html" title="trait aho_corasick::state_id::StateID">StateID</a>&gt; {
    builder: &amp;'a <a class="struct" href="struct.Builder.html" title="struct aho_corasick::nfa::Builder">Builder</a>,
    prefilter: <a class="struct" href="../prefilter/struct.Builder.html" title="struct aho_corasick::prefilter::Builder">Builder</a>,
    nfa: <a class="struct" href="struct.NFA.html" title="struct aho_corasick::nfa::NFA">NFA</a>&lt;S&gt;,
    byte_classes: <a class="struct" href="../classes/struct.ByteClassBuilder.html" title="struct aho_corasick::classes::ByteClassBuilder">ByteClassBuilder</a>,
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A compiler uses a builder configuration and builds up the NFA formulation
of an Aho-Corasick automaton. This roughly corresponds to the standard
formulation described in textbooks.</p>
</div></details><h2 id="fields" class="fields small-section-header">Fields<a href="#fields" class="anchor"></a></h2><span id="structfield.builder" class="structfield small-section-header"><a href="#structfield.builder" class="anchor field"></a><code>builder: &amp;'a <a class="struct" href="struct.Builder.html" title="struct aho_corasick::nfa::Builder">Builder</a></code></span><span id="structfield.prefilter" class="structfield small-section-header"><a href="#structfield.prefilter" class="anchor field"></a><code>prefilter: <a class="struct" href="../prefilter/struct.Builder.html" title="struct aho_corasick::prefilter::Builder">Builder</a></code></span><span id="structfield.nfa" class="structfield small-section-header"><a href="#structfield.nfa" class="anchor field"></a><code>nfa: <a class="struct" href="struct.NFA.html" title="struct aho_corasick::nfa::NFA">NFA</a>&lt;S&gt;</code></span><span id="structfield.byte_classes" class="structfield small-section-header"><a href="#structfield.byte_classes" class="anchor field"></a><code>byte_classes: <a class="struct" href="../classes/struct.ByteClassBuilder.html" title="struct aho_corasick::classes::ByteClassBuilder">ByteClassBuilder</a></code></span><h2 id="implementations" class="small-section-header">Implementations<a href="#implementations" class="anchor"></a></h2><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#619-1201" title="goto source code">source</a></div><a href="#impl" class="anchor"></a><h3 class="code-header in-band">impl&lt;'a, S:&nbsp;<a class="trait" href="../state_id/trait.StateID.html" title="trait aho_corasick::state_id::StateID">StateID</a>&gt; <a class="struct" href="struct.Compiler.html" title="struct aho_corasick::nfa::Compiler">Compiler</a>&lt;'a, S&gt;</h3></div></summary><div class="impl-items"><div id="method.new" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#620-638" title="goto source code">source</a></div><a href="#method.new" class="anchor"></a><h4 class="code-header">fn <a href="#method.new" class="fnname">new</a>(builder: &amp;'a <a class="struct" href="struct.Builder.html" title="struct aho_corasick::nfa::Builder">Builder</a>) -&gt; <a class="enum" href="../../core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="struct.Compiler.html" title="struct aho_corasick::nfa::Compiler">Compiler</a>&lt;'a, S&gt;, <a class="struct" href="../error/struct.Error.html" title="struct aho_corasick::error::Error">Error</a>&gt;</h4></div><div id="method.compile" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#640-665" title="goto source code">source</a></div><a href="#method.compile" class="anchor"></a><h4 class="code-header">fn <a href="#method.compile" class="fnname">compile</a>&lt;I, P&gt;(self, patterns: I) -&gt; <a class="enum" href="../../core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="struct" href="struct.NFA.html" title="struct aho_corasick::nfa::NFA">NFA</a>&lt;S&gt;, <a class="struct" href="../error/struct.Error.html" title="struct aho_corasick::error::Error">Error</a>&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;I: <a class="trait" href="../../core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = P&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;P: <a class="trait" href="../../core/convert/trait.AsRef.html" title="trait core::convert::AsRef">AsRef</a>&lt;<a class="primitive" href="../../std/primitive.slice.html">[</a><a class="primitive" href="../../std/primitive.u8.html">u8</a><a class="primitive" href="../../std/primitive.slice.html">]</a>&gt;,&nbsp;</span></h4></div><details class="rustdoc-toggle method-toggle" open><summary><div id="method.build_trie" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#671-739" title="goto source code">source</a></div><a href="#method.build_trie" class="anchor"></a><h4 class="code-header">fn <a href="#method.build_trie" class="fnname">build_trie</a>&lt;I, P&gt;(&amp;mut self, patterns: I) -&gt; <a class="enum" href="../../core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;<a class="primitive" href="../../std/primitive.unit.html">()</a>, <a class="struct" href="../error/struct.Error.html" title="struct aho_corasick::error::Error">Error</a>&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;I: <a class="trait" href="../../core/iter/traits/collect/trait.IntoIterator.html" title="trait core::iter::traits::collect::IntoIterator">IntoIterator</a>&lt;Item = P&gt;,<br>&nbsp;&nbsp;&nbsp;&nbsp;P: <a class="trait" href="../../core/convert/trait.AsRef.html" title="trait core::convert::AsRef">AsRef</a>&lt;<a class="primitive" href="../../std/primitive.slice.html">[</a><a class="primitive" href="../../std/primitive.u8.html">u8</a><a class="primitive" href="../../std/primitive.slice.html">]</a>&gt;,&nbsp;</span></h4></div></summary><div class="docblock"><p>This sets up the initial prefix trie that makes up the Aho-Corasick
automaton. Effectively, it creates the basic structure of the
automaton, where every pattern given has a path from the start state to
the end of the pattern.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.fill_failure_transitions_standard" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#842-892" title="goto source code">source</a></div><a href="#method.fill_failure_transitions_standard" class="anchor"></a><h4 class="code-header">fn <a href="#method.fill_failure_transitions_standard" class="fnname">fill_failure_transitions_standard</a>(&amp;mut self)</h4></div></summary><div class="docblock"><p>This routine creates failure transitions according to the standard
textbook formulation of the Aho-Corasick algorithm.</p>
<p>Building failure transitions is the most interesting part of building
the Aho-Corasick automaton, because they are what allow searches to
be performed in linear time. Specifically, a failure transition is
a single transition associated with each state that points back to
the longest proper suffix of the pattern being searched. The failure
transition is followed whenever there exists no transition on the
current state for the current input byte. If there is no other proper
suffix, then the failure transition points back to the starting state.</p>
<p>For example, let’s say we built an Aho-Corasick automaton with the
following patterns: ‘abcd’ and ‘cef’. The trie looks like this:</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore"><code>         <span class="ident">a</span> <span class="op">-</span> <span class="ident">S1</span> <span class="op">-</span> <span class="ident">b</span> <span class="op">-</span> <span class="ident">S2</span> <span class="op">-</span> <span class="ident">c</span> <span class="op">-</span> <span class="ident">S3</span> <span class="op">-</span> <span class="ident">d</span> <span class="op">-</span> <span class="ident">S4</span><span class="op">*</span>
        <span class="op">/</span>
    <span class="ident">S0</span> <span class="op">-</span> <span class="ident">c</span> <span class="op">-</span> <span class="ident">S5</span> <span class="op">-</span> <span class="ident">e</span> <span class="op">-</span> <span class="ident">S6</span> <span class="op">-</span> <span class="ident">f</span> <span class="op">-</span> <span class="ident">S7</span><span class="kw-2">*</span></code></pre></div>
<p>At this point, it should be fairly straight-forward to see how this
trie can be used in a simplistic way. At any given position in the
text we’re searching (called the “subject” string), all we need to do
is follow the transitions in the trie by consuming one transition for
each byte in the subject string. If we reach a match state, then we can
report that location as a match.</p>
<p>The trick comes when searching a subject string like ‘abcef’. We’ll
initially follow the transition from S0 to S1 and wind up in S3 after
observng the ‘c’ byte. At this point, the next byte is ‘e’ but state
S3 has no transition for ‘e’, so the search fails. We then would need
to restart the search at the next position in ‘abcef’, which
corresponds to ‘b’. The match would fail, but the next search starting
at ‘c’ would finally succeed. The problem with this approach is that
we wind up searching the subject string potentially many times. In
effect, this makes the algorithm have worst case <code>O(n * m)</code> complexity,
where <code>n ~ len(subject)</code> and <code>m ~ len(all patterns)</code>. We would instead
like to achieve a <code>O(n + m)</code> worst case complexity.</p>
<p>This is where failure transitions come in. Instead of dying at S3 in
the first search, the automaton can instruct the search to move to
another part of the automaton that corresponds to a suffix of what
we’ve seen so far. Recall that we’ve seen ‘abc’ in the subject string,
and the automaton does indeed have a non-empty suffix, ‘c’, that could
potentially lead to another match. Thus, the actual Aho-Corasick
automaton for our patterns in this case looks like this:</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore"><code>         <span class="ident">a</span> <span class="op">-</span> <span class="ident">S1</span> <span class="op">-</span> <span class="ident">b</span> <span class="op">-</span> <span class="ident">S2</span> <span class="op">-</span> <span class="ident">c</span> <span class="op">-</span> <span class="ident">S3</span> <span class="op">-</span> <span class="ident">d</span> <span class="op">-</span> <span class="ident">S4</span><span class="op">*</span>
        <span class="op">/</span>                      <span class="op">/</span>
       <span class="op">/</span>       <span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span><span class="op">-</span>
      <span class="op">/</span>       <span class="op">/</span>
    <span class="ident">S0</span> <span class="op">-</span> <span class="ident">c</span> <span class="op">-</span> <span class="ident">S5</span> <span class="op">-</span> <span class="ident">e</span> <span class="op">-</span> <span class="ident">S6</span> <span class="op">-</span> <span class="ident">f</span> <span class="op">-</span> <span class="ident">S7</span><span class="kw-2">*</span></code></pre></div>
<p>That is, we have a failure transition from S3 to S5, which is followed
exactly in cases when we are in state S3 but see any byte other than
‘d’ (that is, we’ve “failed” to find a match in this portion of our
trie). We know we can transition back to S5 because we’ve already seen
a ‘c’ byte, so we don’t need to re-scan it. We can then pick back up
with the search starting at S5 and complete our match.</p>
<p>Adding failure transitions to a trie is fairly simple, but subtle. The
key issue is that you might have multiple failure transition that you
need to follow. For example, look at the trie for the patterns
‘abcd’, ‘b’, ‘bcd’ and ‘cd’:</p>

<div class='information'><div class='tooltip ignore'>ⓘ</div></div><div class="example-wrap"><pre class="rust rust-example-rendered ignore"><code>       <span class="op">-</span> <span class="ident">a</span> <span class="op">-</span> <span class="ident">S1</span> <span class="op">-</span> <span class="ident">b</span> <span class="op">-</span> <span class="ident">S2</span> <span class="op">-</span> <span class="ident">c</span> <span class="op">-</span> <span class="ident">S3</span> <span class="op">-</span> <span class="ident">d</span> <span class="op">-</span> <span class="ident">S4</span><span class="op">*</span>
      <span class="op">/</span>
    <span class="ident">S0</span> <span class="op">-</span> <span class="ident">b</span> <span class="op">-</span> <span class="ident">S5</span><span class="op">*</span> <span class="op">-</span> <span class="ident">c</span> <span class="op">-</span> <span class="ident">S6</span> <span class="op">-</span> <span class="ident">d</span> <span class="op">-</span> <span class="ident">S7</span><span class="op">*</span>
      \
       <span class="op">-</span> <span class="ident">c</span> <span class="op">-</span> <span class="ident">S8</span> <span class="op">-</span> <span class="ident">d</span> <span class="op">-</span> <span class="ident">S9</span><span class="kw-2">*</span></code></pre></div>
<p>The failure transitions for this trie are defined from S2 to S5,
S3 to S6 and S6 to S8. Moreover, state S2 needs to track that it
corresponds to a match, since its failure transition to S5 is itself
a match state.</p>
<p>Perhaps simplest way to think about adding these failure transitions
is recursively. That is, if you know the failure transitions for every
possible previous state that could be visited (e.g., when computing the
failure transition for S3, you already know the failure transitions
for S0, S1 and S2), then you can simply follow the failure transition
of the previous state and check whether the incoming transition is
defined after following the failure transition.</p>
<p>For example, when determining the failure state for S3, by our
assumptions, we already know that there is a failure transition from
S2 (the previous state) to S5. So we follow that transition and check
whether the transition connecting S2 to S3 is defined. Indeed, it is,
as there is a transition from S5 to S6 for the byte ‘c’. If no such
transition existed, we could keep following the failure transitions
until we reach the start state, which is the failure transition for
every state that has no corresponding proper suffix.</p>
<p>We don’t actually use recursion to implement this, but instead, use a
breadth first search of the automaton. Our base case is the start
state, whose failure transition is just a transition to itself.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.fill_failure_transitions_leftmost" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#924-1102" title="goto source code">source</a></div><a href="#method.fill_failure_transitions_leftmost" class="anchor"></a><h4 class="code-header">fn <a href="#method.fill_failure_transitions_leftmost" class="fnname">fill_failure_transitions_leftmost</a>(&amp;mut self)</h4></div></summary><div class="docblock"><p>This routine is just like fill_failure_transitions_standard, except
it adds failure transitions in a way that preserves leftmost match
semantics (for both leftmost-first and leftmost-longest).</p>
<p>The algorithms are so similar that it would be possible to write it
generically. But doing so without overhead would require a bit of
ceremony, so we just copy it and add in the extra leftmost logic.
Moreover, the standard algorithm above is so simple that it feels like
a crime to disturb it.</p>
<p>In effect, this proceeds just like the standard approach, but we
specifically add only a subset of all failure transitions. Namely, we
only add failure transitions that either do not occur after a match
or failure transitions that do occur after a match but preserve the
match. The comments in the implementation below should help.</p>
<p>N.B. The only differences in the automaton between leftmost-first and
leftmost-longest are in trie construction. Otherwise, both have exactly
the same set of failure transitions. leftmost-longest adds everything
to the trie, where as leftmost-first skips any patterns for which there
exists a prefix of it that was added earlier.</p>
<p>N.B. I came up with this algorithm on my own, and after scouring all of
the other AC implementations I know of (Perl, Snort, many on GitHub).
I couldn’t find any that implement leftmost semantics like this.
Perl of course needs leftmost-first semantics, but they implement it
with a seeming hack at <em>search</em> time instead of encoding it into the
automaton. There are also a couple Java libraries that support leftmost
longest semantics, but they do it by building a queue of matches at
search time, which is even worse than what Perl is doing. —AG</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.queued_set" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#1110-1116" title="goto source code">source</a></div><a href="#method.queued_set" class="anchor"></a><h4 class="code-header">fn <a href="#method.queued_set" class="fnname">queued_set</a>(&amp;self) -&gt; <a class="struct" href="struct.QueuedSet.html" title="struct aho_corasick::nfa::QueuedSet">QueuedSet</a>&lt;S&gt;</h4></div></summary><div class="docblock"><p>Returns a set that tracked queued states.</p>
<p>This is only necessary when ASCII case insensitivity is enabled, since
it is the only way to visit the same state twice. Otherwise, this
returns an inert set that nevers adds anything and always reports
<code>false</code> for every member test.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.add_start_state_loop" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#1127-1135" title="goto source code">source</a></div><a href="#method.add_start_state_loop" class="anchor"></a><h4 class="code-header">fn <a href="#method.add_start_state_loop" class="fnname">add_start_state_loop</a>(&amp;mut self)</h4></div></summary><div class="docblock"><p>Set the failure transitions on the start state to loop back to the
start state. This effectively permits the Aho-Corasick automaton to
match at any position. This is also required for finding the next
state to terminate, namely, finding the next state should never return
a fail_id.</p>
<p>This must be done after building the initial trie, since trie
construction depends on transitions to <code>fail_id</code> to determine whether a
state already exists or not.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.close_start_state_loop" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#1151-1163" title="goto source code">source</a></div><a href="#method.close_start_state_loop" class="anchor"></a><h4 class="code-header">fn <a href="#method.close_start_state_loop" class="fnname">close_start_state_loop</a>(&amp;mut self)</h4></div></summary><div class="docblock"><p>Remove the start state loop by rewriting any transitions on the start
state back to the start state with transitions to the dead state.</p>
<p>The loop is only closed when two conditions are met: the start state
is a match state and the match kind is leftmost-first or
leftmost-longest. (Alternatively, if this is an anchored automaton,
then the start state is always closed, regardless of aforementioned
conditions.)</p>
<p>The reason for this is that under leftmost semantics, a start state
that is also a match implies that we should never restart the search
process. We allow normal transitions out of the start state, but if
none exist, we transition to the dead state, which signals that
searching should stop.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.add_dead_state_loop" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#1168-1173" title="goto source code">source</a></div><a href="#method.add_dead_state_loop" class="anchor"></a><h4 class="code-header">fn <a href="#method.add_dead_state_loop" class="fnname">add_dead_state_loop</a>(&amp;mut self)</h4></div></summary><div class="docblock"><p>Sets all transitions on the dead state to point back to the dead state.
Normally, missing transitions map back to the failure state, but the
point of the dead state is to act as a sink that can never be escaped.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.calculate_size" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#1176-1182" title="goto source code">source</a></div><a href="#method.calculate_size" class="anchor"></a><h4 class="code-header">fn <a href="#method.calculate_size" class="fnname">calculate_size</a>(&amp;mut self)</h4></div></summary><div class="docblock"><p>Computes the total amount of heap used by this NFA in bytes.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.add_state" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#1189-1195" title="goto source code">source</a></div><a href="#method.add_state" class="anchor"></a><h4 class="code-header">fn <a href="#method.add_state" class="fnname">add_state</a>(&amp;mut self, depth: <a class="primitive" href="../../std/primitive.usize.html">usize</a>) -&gt; <a class="enum" href="../../core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;S, <a class="struct" href="../error/struct.Error.html" title="struct aho_corasick::error::Error">Error</a>&gt;</h4></div></summary><div class="docblock"><p>Add a new state to the underlying NFA with the given depth. The depth
is used to determine how to represent the transitions.</p>
<p>If adding the new state would overflow the chosen state ID
representation, then this returns an error.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.match_kind" class="method has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#1198-1200" title="goto source code">source</a></div><a href="#method.match_kind" class="anchor"></a><h4 class="code-header">fn <a href="#method.match_kind" class="fnname">match_kind</a>(&amp;self) -&gt; <a class="enum" href="../ahocorasick/enum.MatchKind.html" title="enum aho_corasick::ahocorasick::MatchKind">MatchKind</a></h4></div></summary><div class="docblock"><p>Returns the match kind configured on the underlying builder.</p>
</div></details></div></details><h2 id="trait-implementations" class="small-section-header">Trait Implementations<a href="#trait-implementations" class="anchor"></a></h2><div id="trait-implementations-list"><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-Debug" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#611" title="goto source code">source</a></div><a href="#impl-Debug" class="anchor"></a><h3 class="code-header in-band">impl&lt;'a, S:&nbsp;<a class="trait" href="../../core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> + <a class="trait" href="../state_id/trait.StateID.html" title="trait aho_corasick::state_id::StateID">StateID</a>&gt; <a class="trait" href="../../core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> for <a class="struct" href="struct.Compiler.html" title="struct aho_corasick::nfa::Compiler">Compiler</a>&lt;'a, S&gt;</h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.fmt" class="method trait-impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/aho_corasick/nfa.rs.html#611" title="goto source code">source</a></div><a href="#method.fmt" class="anchor"></a><h4 class="code-header">fn <a href="../../core/fmt/trait.Debug.html#tymethod.fmt" class="fnname">fmt</a>(&amp;self, f: &amp;mut <a class="struct" href="../../core/fmt/struct.Formatter.html" title="struct core::fmt::Formatter">Formatter</a>&lt;'_&gt;) -&gt; <a class="type" href="../../core/fmt/type.Result.html" title="type core::fmt::Result">Result</a></h4></div></summary><div class='docblock'><p>Formats the value using the given formatter. <a href="../../core/fmt/trait.Debug.html#tymethod.fmt">Read more</a></p>
</div></details></div></details></div><h2 id="synthetic-implementations" class="small-section-header">Auto Trait Implementations<a href="#synthetic-implementations" class="anchor"></a></h2><div id="synthetic-implementations-list"><div id="impl-RefUnwindSafe" class="impl has-srclink"><div class="rightside"></div><a href="#impl-RefUnwindSafe" class="anchor"></a><h3 class="code-header in-band">impl&lt;'a, S&gt; <a class="trait" href="../../core/panic/unwind_safe/trait.RefUnwindSafe.html" title="trait core::panic::unwind_safe::RefUnwindSafe">RefUnwindSafe</a> for <a class="struct" href="struct.Compiler.html" title="struct aho_corasick::nfa::Compiler">Compiler</a>&lt;'a, S&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;S: <a class="trait" href="../../core/panic/unwind_safe/trait.RefUnwindSafe.html" title="trait core::panic::unwind_safe::RefUnwindSafe">RefUnwindSafe</a>,&nbsp;</span></h3></div><div id="impl-Send" class="impl has-srclink"><div class="rightside"></div><a href="#impl-Send" class="anchor"></a><h3 class="code-header in-band">impl&lt;'a, S&gt; <a class="trait" href="../../core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> for <a class="struct" href="struct.Compiler.html" title="struct aho_corasick::nfa::Compiler">Compiler</a>&lt;'a, S&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;S: <a class="trait" href="../../core/marker/trait.Send.html" title="trait core::marker::Send">Send</a>,&nbsp;</span></h3></div><div id="impl-Sync" class="impl has-srclink"><div class="rightside"></div><a href="#impl-Sync" class="anchor"></a><h3 class="code-header in-band">impl&lt;'a, S&gt; <a class="trait" href="../../core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> for <a class="struct" href="struct.Compiler.html" title="struct aho_corasick::nfa::Compiler">Compiler</a>&lt;'a, S&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;S: <a class="trait" href="../../core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a>,&nbsp;</span></h3></div><div id="impl-Unpin" class="impl has-srclink"><div class="rightside"></div><a href="#impl-Unpin" class="anchor"></a><h3 class="code-header in-band">impl&lt;'a, S&gt; <a class="trait" href="../../core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a> for <a class="struct" href="struct.Compiler.html" title="struct aho_corasick::nfa::Compiler">Compiler</a>&lt;'a, S&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;S: <a class="trait" href="../../core/marker/trait.Unpin.html" title="trait core::marker::Unpin">Unpin</a>,&nbsp;</span></h3></div><div id="impl-UnwindSafe" class="impl has-srclink"><div class="rightside"></div><a href="#impl-UnwindSafe" class="anchor"></a><h3 class="code-header in-band">impl&lt;'a, S&gt; <a class="trait" href="../../core/panic/unwind_safe/trait.UnwindSafe.html" title="trait core::panic::unwind_safe::UnwindSafe">UnwindSafe</a> for <a class="struct" href="struct.Compiler.html" title="struct aho_corasick::nfa::Compiler">Compiler</a>&lt;'a, S&gt; <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;S: <a class="trait" href="../../core/panic/unwind_safe/trait.UnwindSafe.html" title="trait core::panic::unwind_safe::UnwindSafe">UnwindSafe</a>,&nbsp;</span></h3></div></div><h2 id="blanket-implementations" class="small-section-header">Blanket Implementations<a href="#blanket-implementations" class="anchor"></a></h2><div id="blanket-implementations-list"><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-Any" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/any.rs.html#132-136" title="goto source code">source</a></div><a href="#impl-Any" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="../../core/any/trait.Any.html" title="trait core::any::Any">Any</a> for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: 'static + ?<a class="trait" href="../../core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.type_id" class="method trait-impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/any.rs.html#133" title="goto source code">source</a></div><a href="#method.type_id" class="anchor"></a><h4 class="code-header">pub fn <a href="../../core/any/trait.Any.html#tymethod.type_id" class="fnname">type_id</a>(&amp;self) -&gt; <a class="struct" href="../../core/any/struct.TypeId.html" title="struct core::any::TypeId">TypeId</a></h4></div></summary><div class='docblock'><p>Gets the <code>TypeId</code> of <code>self</code>. <a href="../../core/any/trait.Any.html#tymethod.type_id">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-Borrow%3CT%3E" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/borrow.rs.html#209-214" title="goto source code">source</a></div><a href="#impl-Borrow%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="../../core/borrow/trait.Borrow.html" title="trait core::borrow::Borrow">Borrow</a>&lt;T&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="../../core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.borrow" class="method trait-impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/borrow.rs.html#211" title="goto source code">source</a></div><a href="#method.borrow" class="anchor"></a><h4 class="code-header">pub fn <a href="../../core/borrow/trait.Borrow.html#tymethod.borrow" class="fnname">borrow</a>(&amp;self) -&gt; <a class="primitive" href="../../std/primitive.reference.html">&amp;</a>T</h4></div></summary><div class='docblock'><p>Immutably borrows from an owned value. <a href="../../core/borrow/trait.Borrow.html#tymethod.borrow">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-BorrowMut%3CT%3E" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/borrow.rs.html#218-222" title="goto source code">source</a></div><a href="#impl-BorrowMut%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="../../core/borrow/trait.BorrowMut.html" title="trait core::borrow::BorrowMut">BorrowMut</a>&lt;T&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;T: ?<a class="trait" href="../../core/marker/trait.Sized.html" title="trait core::marker::Sized">Sized</a>,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.borrow_mut" class="method trait-impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/borrow.rs.html#219" title="goto source code">source</a></div><a href="#method.borrow_mut" class="anchor"></a><h4 class="code-header">pub fn <a href="../../core/borrow/trait.BorrowMut.html#tymethod.borrow_mut" class="fnname">borrow_mut</a>(&amp;mut self) -&gt; <a class="primitive" href="../../std/primitive.reference.html">&amp;mut </a>T</h4></div></summary><div class='docblock'><p>Mutably borrows from an owned value. <a href="../../core/borrow/trait.BorrowMut.html#tymethod.borrow_mut">Read more</a></p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-From%3CT%3E" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/convert/mod.rs.html#549-553" title="goto source code">source</a></div><a href="#impl-From%3CT%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T&gt; <a class="trait" href="../../core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt; for T</h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.from" class="method trait-impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/convert/mod.rs.html#550" title="goto source code">source</a></div><a href="#method.from" class="anchor"></a><h4 class="code-header">pub fn <a href="../../core/convert/trait.From.html#tymethod.from" class="fnname">from</a>(t: T) -&gt; T</h4></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-Into%3CU%3E" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/convert/mod.rs.html#537-544" title="goto source code">source</a></div><a href="#impl-Into%3CU%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="../../core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="../../core/convert/trait.From.html" title="trait core::convert::From">From</a>&lt;T&gt;,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle method-toggle" open><summary><div id="method.into" class="method trait-impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/convert/mod.rs.html#541" title="goto source code">source</a></div><a href="#method.into" class="anchor"></a><h4 class="code-header">pub fn <a href="../../core/convert/trait.Into.html#tymethod.into" class="fnname">into</a>(self) -&gt; U</h4></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-TryFrom%3CU%3E" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/convert/mod.rs.html#589-598" title="goto source code">source</a></div><a href="#impl-TryFrom%3CU%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="../../core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="../../core/convert/trait.Into.html" title="trait core::convert::Into">Into</a>&lt;T&gt;,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><div id="associatedtype.Error" class="type trait-impl has-srclink"><a href="#associatedtype.Error" class="anchor"></a><h4 class="code-header">type <a href="../../core/convert/trait.TryFrom.html#associatedtype.Error" class="associatedtype">Error</a> = <a class="enum" href="../../core/convert/enum.Infallible.html" title="enum core::convert::Infallible">Infallible</a></h4></div></summary><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.try_from" class="method trait-impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/convert/mod.rs.html#595" title="goto source code">source</a></div><a href="#method.try_from" class="anchor"></a><h4 class="code-header">pub fn <a href="../../core/convert/trait.TryFrom.html#tymethod.try_from" class="fnname">try_from</a>(value: U) -&gt; <a class="enum" href="../../core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;T, &lt;T as <a class="trait" href="../../core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;U&gt;&gt;::<a class="associatedtype" href="../../core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details><details class="rustdoc-toggle implementors-toggle" open><summary><div id="impl-TryInto%3CU%3E" class="impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/convert/mod.rs.html#574-583" title="goto source code">source</a></div><a href="#impl-TryInto%3CU%3E" class="anchor"></a><h3 class="code-header in-band">impl&lt;T, U&gt; <a class="trait" href="../../core/convert/trait.TryInto.html" title="trait core::convert::TryInto">TryInto</a>&lt;U&gt; for T <span class="where fmt-newline">where<br>&nbsp;&nbsp;&nbsp;&nbsp;U: <a class="trait" href="../../core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;,&nbsp;</span></h3></div></summary><div class="impl-items"><details class="rustdoc-toggle" open><summary><div id="associatedtype.Error-1" class="type trait-impl has-srclink"><a href="#associatedtype.Error-1" class="anchor"></a><h4 class="code-header">type <a href="../../core/convert/trait.TryInto.html#associatedtype.Error" class="associatedtype">Error</a> = &lt;U as <a class="trait" href="../../core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="../../core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a></h4></div></summary><div class='docblock'><p>The type returned in the event of a conversion error.</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><div id="method.try_into" class="method trait-impl has-srclink"><div class="rightside"><a class="srclink" href="../../src/core/convert/mod.rs.html#580" title="goto source code">source</a></div><a href="#method.try_into" class="anchor"></a><h4 class="code-header">pub fn <a href="../../core/convert/trait.TryInto.html#tymethod.try_into" class="fnname">try_into</a>(self) -&gt; <a class="enum" href="../../core/result/enum.Result.html" title="enum core::result::Result">Result</a>&lt;U, &lt;U as <a class="trait" href="../../core/convert/trait.TryFrom.html" title="trait core::convert::TryFrom">TryFrom</a>&lt;T&gt;&gt;::<a class="associatedtype" href="../../core/convert/trait.TryFrom.html#associatedtype.Error" title="type core::convert::TryFrom::Error">Error</a>&gt;</h4></div></summary><div class='docblock'><p>Performs the conversion.</p>
</div></details></div></details></div></section><section id="search" class="content hidden"></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-current-crate="aho_corasick" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.60.0-nightly (5e57faa78 2022-01-19)" ></div>
</body></html>