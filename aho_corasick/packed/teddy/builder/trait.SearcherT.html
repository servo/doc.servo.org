<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="A trait that provides dynamic dispatch over the different possible Teddy variants on the same algorithm."><title>SearcherT in aho_corasick::packed::teddy::builder - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../../../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../../../../" data-static-root-path="../../../../static.files/" data-current-crate="aho_corasick" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.1 (3f5fd8dd4 2024-08-06)" data-channel="1.80.1" data-search-js="search-d52510db62a78183.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../../../../static.files/storage-118b08c4c78b968e.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../../../../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../../../aho_corasick/index.html">aho_corasick</a><span class="version">1.1.3</span></h2></div><h2 class="location"><a href="#">SearcherT</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.find">find</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In aho_corasick::packed::teddy::builder</a></h2></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Trait <a href="../../../index.html">aho_corasick</a>::<wbr><a href="../../index.html">packed</a>::<wbr><a href="../index.html">teddy</a>::<wbr><a href="index.html">builder</a>::<wbr><a class="trait" href="#">SearcherT</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#416-448">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><pre class="rust item-decl"><code>trait SearcherT: <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/fmt/trait.Debug.html" title="trait core::fmt::Debug">Debug</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/marker/trait.Send.html" title="trait core::marker::Send">Send</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/marker/trait.Sync.html" title="trait core::marker::Sync">Sync</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/panic/unwind_safe/trait.UnwindSafe.html" title="trait core::panic::unwind_safe::UnwindSafe">UnwindSafe</a> + <a class="trait" href="https://doc.rust-lang.org/1.80.1/core/panic/unwind_safe/trait.RefUnwindSafe.html" title="trait core::panic::unwind_safe::RefUnwindSafe">RefUnwindSafe</a> + 'static {
    // Required method
    unsafe fn <a href="#tymethod.find" class="fn">find</a>(&amp;self, start: <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.u8.html">u8</a>, end: <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.u8.html">u8</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../generic/struct.Match.html" title="struct aho_corasick::packed::teddy::generic::Match">Match</a>&gt;;
}</code></pre><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>A trait that provides dynamic dispatch over the different possible Teddy
variants on the same algorithm.</p>
<p>On <code>x86_64</code> for example, it isn’t known until runtime which of 12 possible
variants will be used. One might use one of the four slim 128-bit vector
variants, or one of the four 256-bit vector variants or even one of the
four fat 256-bit vector variants.</p>
<p>Since this choice is generally made when the Teddy searcher is constructed
and this choice is based on the patterns given and what the current CPU
supports, it follows that there must be some kind of indirection at search
time that “selects” the variant chosen at build time.</p>
<p>There are a few different ways to go about this. One approach is to use an
enum. It works fine, but in my experiments, this generally results in worse
codegen. Another approach, which is what we use here, is dynamic dispatch
via a trait object. We basically implement this trait for each possible
variant, select the variant we want at build time and convert it to a
trait object for use at search time.</p>
<p>Another approach is to use function pointers and stick each of the possible
variants into a union. This is essentially isomorphic to the dynamic
dispatch approach, but doesn’t require any allocations. Since this crate
requires <code>alloc</code>, there’s no real reason (AFAIK) to go down this path. (The
<code>memchr</code> crate does this.)</p>
</div></details><h2 id="required-methods" class="section-header">Required Methods<a href="#required-methods" class="anchor">§</a></h2><div class="methods"><details class="toggle method-toggle" open><summary><section id="tymethod.find" class="method"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#447">source</a><h4 class="code-header">unsafe fn <a href="#tymethod.find" class="fn">find</a>(&amp;self, start: <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.u8.html">u8</a>, end: <a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.pointer.html">*const </a><a class="primitive" href="https://doc.rust-lang.org/1.80.1/std/primitive.u8.html">u8</a>) -&gt; <a class="enum" href="https://doc.rust-lang.org/1.80.1/core/option/enum.Option.html" title="enum core::option::Option">Option</a>&lt;<a class="struct" href="../generic/struct.Match.html" title="struct aho_corasick::packed::teddy::generic::Match">Match</a>&gt;</h4></section></summary><div class="docblock"><p>Execute a search on the given haystack (identified by <code>start</code> and <code>end</code>
raw pointers).</p>
<h5 id="safety"><a class="doc-anchor" href="#safety">§</a>Safety</h5>
<p>Essentially, the <code>start</code> and <code>end</code> pointers must be valid and point
to a haystack one can read. As long as you derive them from, for
example, a <code>&amp;[u8]</code>, they should automatically satisfy all of the safety
obligations:</p>
<ul>
<li>Both <code>start</code> and <code>end</code> must be valid for reads.</li>
<li>Both <code>start</code> and <code>end</code> must point to an initialized value.</li>
<li>Both <code>start</code> and <code>end</code> must point to the same allocated object and
must either be in bounds or at most one byte past the end of the
allocated object.</li>
<li>Both <code>start</code> and <code>end</code> must be <em>derived from</em> a pointer to the same
object.</li>
<li>The distance between <code>start</code> and <code>end</code> must not overflow <code>isize</code>.</li>
<li>The distance being in bounds must not rely on “wrapping around” the
address space.</li>
<li>It must be the case that <code>start &lt;= end</code>.</li>
<li><code>end - start</code> must be greater than the minimum length for this
searcher.</li>
</ul>
<p>Also, it is expected that implementations of this trait will tag this
method with a <code>target_feature</code> attribute. Callers must ensure that
they are executing this method in an environment where that attribute
is valid.</p>
</div></details></div><h2 id="implementors" class="section-header">Implementors<a href="#implementors" class="anchor">§</a></h2><div id="implementors-list"><section id="impl-SearcherT-for-FatAVX2%3C1%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#658">source</a><a href="#impl-SearcherT-for-FatAVX2%3C1%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.FatAVX2.html" title="struct aho_corasick::packed::teddy::builder::x86_64::FatAVX2">FatAVX2</a>&lt;1&gt;</h3></section><section id="impl-SearcherT-for-FatAVX2%3C2%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#659">source</a><a href="#impl-SearcherT-for-FatAVX2%3C2%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.FatAVX2.html" title="struct aho_corasick::packed::teddy::builder::x86_64::FatAVX2">FatAVX2</a>&lt;2&gt;</h3></section><section id="impl-SearcherT-for-FatAVX2%3C3%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#660">source</a><a href="#impl-SearcherT-for-FatAVX2%3C3%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.FatAVX2.html" title="struct aho_corasick::packed::teddy::builder::x86_64::FatAVX2">FatAVX2</a>&lt;3&gt;</h3></section><section id="impl-SearcherT-for-FatAVX2%3C4%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#661">source</a><a href="#impl-SearcherT-for-FatAVX2%3C4%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.FatAVX2.html" title="struct aho_corasick::packed::teddy::builder::x86_64::FatAVX2">FatAVX2</a>&lt;4&gt;</h3></section><section id="impl-SearcherT-for-SlimAVX2%3C1%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#595">source</a><a href="#impl-SearcherT-for-SlimAVX2%3C1%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.SlimAVX2.html" title="struct aho_corasick::packed::teddy::builder::x86_64::SlimAVX2">SlimAVX2</a>&lt;1&gt;</h3></section><section id="impl-SearcherT-for-SlimAVX2%3C2%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#596">source</a><a href="#impl-SearcherT-for-SlimAVX2%3C2%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.SlimAVX2.html" title="struct aho_corasick::packed::teddy::builder::x86_64::SlimAVX2">SlimAVX2</a>&lt;2&gt;</h3></section><section id="impl-SearcherT-for-SlimAVX2%3C3%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#597">source</a><a href="#impl-SearcherT-for-SlimAVX2%3C3%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.SlimAVX2.html" title="struct aho_corasick::packed::teddy::builder::x86_64::SlimAVX2">SlimAVX2</a>&lt;3&gt;</h3></section><section id="impl-SearcherT-for-SlimAVX2%3C4%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#598">source</a><a href="#impl-SearcherT-for-SlimAVX2%3C4%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.SlimAVX2.html" title="struct aho_corasick::packed::teddy::builder::x86_64::SlimAVX2">SlimAVX2</a>&lt;4&gt;</h3></section><section id="impl-SearcherT-for-SlimSSSE3%3C1%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#522">source</a><a href="#impl-SearcherT-for-SlimSSSE3%3C1%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.SlimSSSE3.html" title="struct aho_corasick::packed::teddy::builder::x86_64::SlimSSSE3">SlimSSSE3</a>&lt;1&gt;</h3></section><section id="impl-SearcherT-for-SlimSSSE3%3C2%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#523">source</a><a href="#impl-SearcherT-for-SlimSSSE3%3C2%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.SlimSSSE3.html" title="struct aho_corasick::packed::teddy::builder::x86_64::SlimSSSE3">SlimSSSE3</a>&lt;2&gt;</h3></section><section id="impl-SearcherT-for-SlimSSSE3%3C3%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#524">source</a><a href="#impl-SearcherT-for-SlimSSSE3%3C3%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.SlimSSSE3.html" title="struct aho_corasick::packed::teddy::builder::x86_64::SlimSSSE3">SlimSSSE3</a>&lt;3&gt;</h3></section><section id="impl-SearcherT-for-SlimSSSE3%3C4%3E" class="impl"><a class="src rightside" href="../../../../src/aho_corasick/packed/teddy/builder.rs.html#525">source</a><a href="#impl-SearcherT-for-SlimSSSE3%3C4%3E" class="anchor">§</a><h3 class="code-header">impl <a class="trait" href="trait.SearcherT.html" title="trait aho_corasick::packed::teddy::builder::SearcherT">SearcherT</a> for <a class="struct" href="x86_64/struct.SlimSSSE3.html" title="struct aho_corasick::packed::teddy::builder::x86_64::SlimSSSE3">SlimSSSE3</a>&lt;4&gt;</h3></section></div><script src="../../../../trait.impl/aho_corasick/packed/teddy/builder/trait.SearcherT.js" async></script></section></div></main></body></html>